<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
     integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
     crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
        integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
        crossorigin=""></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
    <script src="calcworkflow/leaflet-easyPrint/dist/bundle.js"></script>
  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="css/styles.css?v=1.0">
  <style>
      #mapid { height: 1000px;
            width: 1900px}
    </style>
</head>

<body>
  <div id="mapid"></div>

  <script>
    var mymap = L.map('mapid').setView([26.63966, 107.913354], 4);
    var tiles = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>',
           maxZoom: 16, minZoom: 2 , opacity: 0.4}).addTo(mymap);
           var printer = L.easyPrint({
                        tileLayer: tiles,
                        filename: 'My map',
                        position:'bottomleft',
                        sizeModes: ['Current', 'A4Landscape', 'A4Portrait'],
                        exportOnly: true,
                        hideControlContainer: true}).addTo(mymap);
            function manualPrint () {
                        printer.printMap('CurrentSize', 'MyManualPrint')
                    }
    var googlespreadsheet= 'https://docs.google.com/spreadsheets/d/1TzWm7242Vd3JpqwN7Jwx-wrR1K6p9i_GylIiC6GkgYk/edit?usp=sharing';
    function init() {
    Tabletop.init( { key: googlespreadsheet,
                     wanted: ['map'],
                     callback: showInfo,
                     simpleSheet: true } )
                   }
    function showInfo(data, tabletop) {
      for(var i = 0; i< data.length; i++){
          console.log(data[i]);
          if(data[i]['Branch'] == 'Hmongic'){
          var marker = L.circleMarker([data[i]['Latitude'], data[i]['Longitude']], { radius: 3, color: '#eb175e', fillColor: '#eb175e', fillOpacity: 1}).bindTooltip(data[i]['Language_name'],{permanent: true}).openTooltip().addTo(mymap);
        }else{
            var marker = L.circleMarker([data[i]['Latitude'], data[i]['Longitude']], { radius: 3, color: '#004cff', fillColor:'#004cff',fillOpacity: 1}).bindTooltip(data[i]['Language_name'],{permanent: true}).openTooltip().addTo(mymap);
        };
      }
    };
    $( document ).ready(init());
  </script>

</body>
</html>
